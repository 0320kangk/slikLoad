<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layoutFile :: layout(~{::body},'shop')}">

<!-- Body-->
<body class="handheld-toolbar-enabled">
<main class="page-wrapper">
    <!-- Size chart modal-->
    <div class="modal fade" id="size-chart">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-secondary">
                    <ul class="nav nav-tabs card-header-tabs" role="tablist" style="margin-bottom: -1rem;">
                        <li class="nav-item"><a class="nav-link fw-medium active" href="#mens" data-bs-toggle="tab"
                                                role="tab" aria-controls="mens" aria-selected="true">Men's sizes</a>
                        </li>
                        <li class="nav-item"><a class="nav-link fw-medium" href="#womens" data-bs-toggle="tab"
                                                role="tab" aria-controls="womens" aria-selected="false">Women's
                            sizes</a></li>
                    </ul>
                    <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="mens" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table fs-sm text-center mb-0">
                                    <thead>
                                    <tr>
                                        <th class="align-middle bg-secondary">US<br>Sizes</th>
                                        <th class="align-middle">Euro<br>Sizes</th>
                                        <th class="align-middle">UK<br>Sizes</th>
                                        <th class="align-middle">Inches</th>
                                        <th class="align-middle">CM</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="bg-secondary fw-medium">6</td>
                                        <td>39</td>
                                        <td>5.5</td>
                                        <td>9.25"</td>
                                        <td>23.5</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">6.5</td>
                                        <td>39</td>
                                        <td>6</td>
                                        <td>9.5"</td>
                                        <td>24.1</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">7</td>
                                        <td>40</td>
                                        <td>6.5</td>
                                        <td>9.625"</td>
                                        <td>24.4</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">7.5</td>
                                        <td>40-41</td>
                                        <td>7</td>
                                        <td>9.75"</td>
                                        <td>24.8</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">8</td>
                                        <td>41</td>
                                        <td>7.5</td>
                                        <td>9.9375"</td>
                                        <td>25.4</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">8.5</td>
                                        <td>41-42</td>
                                        <td>8</td>
                                        <td>10.125"</td>
                                        <td>25.7</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">9</td>
                                        <td>42</td>
                                        <td>8.5</td>
                                        <td>10.25"</td>
                                        <td>26</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">9.5</td>
                                        <td>42-43</td>
                                        <td>9</td>
                                        <td>10.4375"</td>
                                        <td>26.7</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">10</td>
                                        <td>43</td>
                                        <td>9.5</td>
                                        <td>10.5625"</td>
                                        <td>27</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">10.5</td>
                                        <td>43-44</td>
                                        <td>10</td>
                                        <td>10.75"</td>
                                        <td>27.3</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">11</td>
                                        <td>44</td>
                                        <td>10.5</td>
                                        <td>10.9375"</td>
                                        <td>27.9</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">11.5</td>
                                        <td>44-45</td>
                                        <td>11</td>
                                        <td>11.125"</td>
                                        <td>28.3</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">12</td>
                                        <td>45</td>
                                        <td>11.5</td>
                                        <td>11.25"</td>
                                        <td>28.6</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">13</td>
                                        <td>46</td>
                                        <td>12.5</td>
                                        <td>11.5625"</td>
                                        <td>29.4</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">14</td>
                                        <td>47</td>
                                        <td>13.5</td>
                                        <td>11.875"</td>
                                        <td>30.2</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">15</td>
                                        <td>48</td>
                                        <td>14.5</td>
                                        <td>12.1875"</td>
                                        <td>31</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">16</td>
                                        <td>49</td>
                                        <td>15.5</td>
                                        <td>12.5"</td>
                                        <td>31.8</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="womens" role="tabpanel">
                            <div class="table-responsive">
                                <table class="table fs-sm text-center mb-0">
                                    <thead>
                                    <tr>
                                        <th class="align-middle bg-secondary">US<br>Sizes</th>
                                        <th class="align-middle">Euro<br>Sizes</th>
                                        <th class="align-middle">UK<br>Sizes</th>
                                        <th class="align-middle">Inches</th>
                                        <th class="align-middle">CM</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="bg-secondary fw-medium">4</td>
                                        <td>35</td>
                                        <td>2</td>
                                        <td>8.1875"</td>
                                        <td>20.8</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">4.5</td>
                                        <td>35</td>
                                        <td>2.5</td>
                                        <td>8.375"</td>
                                        <td>21.3</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">5</td>
                                        <td>35-36</td>
                                        <td>3</td>
                                        <td>8.5"</td>
                                        <td>21.6</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">5.5</td>
                                        <td>36</td>
                                        <td>3.5</td>
                                        <td>8.75"</td>
                                        <td>22.2</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">6</td>
                                        <td>36-37</td>
                                        <td>4</td>
                                        <td>8.875"</td>
                                        <td>22.5</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">6.5</td>
                                        <td>37</td>
                                        <td>4.5</td>
                                        <td>9.0625"</td>
                                        <td>23</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">7</td>
                                        <td>37-38</td>
                                        <td>5</td>
                                        <td>9.25"</td>
                                        <td>23.5</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">7.5</td>
                                        <td>38</td>
                                        <td>5.5</td>
                                        <td>9.375"</td>
                                        <td>23.8</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">8</td>
                                        <td>38-39</td>
                                        <td>6</td>
                                        <td>9.5"</td>
                                        <td>24.1</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">8.5</td>
                                        <td>39</td>
                                        <td>6.5</td>
                                        <td>9.6875"</td>
                                        <td>24.6</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">9</td>
                                        <td>39-40</td>
                                        <td>7</td>
                                        <td>9.875"</td>
                                        <td>25.1</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">9.5</td>
                                        <td>40</td>
                                        <td>7.5</td>
                                        <td>10"</td>
                                        <td>25.4</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">10</td>
                                        <td>40-41</td>
                                        <td>8</td>
                                        <td>10.1875"</td>
                                        <td>25.9</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">10.5</td>
                                        <td>41</td>
                                        <td>8.5</td>
                                        <td>10.3125"</td>
                                        <td>26.2</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">11</td>
                                        <td>41-42</td>
                                        <td>9</td>
                                        <td>10.5"</td>
                                        <td>26.7</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">11.5</td>
                                        <td>42</td>
                                        <td>9.5</td>
                                        <td>10.6875"</td>
                                        <td>27.1</td>
                                    </tr>
                                    <tr>
                                        <td class="bg-secondary fw-medium">12</td>
                                        <td>42-43</td>
                                        <td>10</td>
                                        <td>10.875"</td>
                                        <td>27.6</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- The auction Modal -->
    <div class="modal" id="auctionModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header border border-0">
                    <h4 class="modal-title">경매 가격 등록</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <hr class="mx-3 border border-2 rounded border-primary bg-primary">


                <!-- Modal body -->
                <div class="modal-body">
                    <form action="" th:action="@{/product/order/buyAuction}" method="post" >
                    <input class="mb-3 form-control rounded-start" th:id="auctionPrice" type="text" th:name="auctionPrice"
                           placeholder="경매 가격을 입력해주세요" value="">
                    <input type="hidden" th:id="memberId" th:name="memberId"
                           th:if="${session.loginMember != null}"
                           th:value="${session.loginMember.getId()}"/>
                    <input type="hidden" th:id="productId" th:name="productId" th:value="${product.id}"/>

                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-danger me-2" data-bs-dismiss="modal">경매 주문</button>
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                    </div>
                    </form>
                </div>


            </div>
        </div>
    </div>

    <!-- Page Title-->
    <div class="page-title-overlap bg-dark pt-4">
        <div class="container d-lg-flex justify-content-between py-2 py-lg-3">
            <div class="order-lg-2 mb-3 mb-lg-0 pt-lg-2">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb breadcrumb-light flex-lg-nowrap justify-content-center justify-content-lg-start">
                        <li class="breadcrumb-item"><a class="text-nowrap" href="shop.html"><i class="ci-home"></i>Home</a>
                        </li>
                        <li class="breadcrumb-item text-nowrap"><a href="#">Shop</a>
                        </li>
                        <li class="breadcrumb-item text-nowrap active" aria-current="page"
                            th:text="${product.name}"></li>
                    </ol>
                </nav>
            </div>
            <div class="order-lg-1 pe-lg-4 text-center text-lg-start">
                <h1 class="h3 text-light mb-0" th:text="${product.name}">제품메인제목</h1>
            </div>
        </div>
    </div>
    <div class="container">
        <!-- Gallery + details-->
        <div class="bg-light shadow-lg rounded-3 px-4 py-3 mb-5">
            <div class="px-lg-3">
                <div class="row">
                    <!-- Product gallery-->
                    <div class="col-lg-7 pe-lg-0 pt-lg-4">
                        <div class="product-gallery">
                            <div class="product-gallery-preview order-sm-2">

                                <div class="product-gallery-preview-item active" id="first">
                                    <img th:src="|/product/images/${product.getProductImagesList().get(0).getStoreFileName()}|"
                                         alt="Product image">
                                </div>
                            </div>
                            <div class="product-gallery-thumblist order-sm-1">
                                <a class="product-gallery-thumblist-item active" href="#first">
                                    <img th:src="|/product/images/${product.getProductImagesList().get(0).getStoreFileName()}|"
                                         alt="Product thumb"></a>
                            </div>
                        </div>
                    </div>
                    <!-- Product details-->
                    <div class="col-lg-5 pt-4 pt-lg-0">
                        <div class="product-details ms-auto pb-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <a href="#reviews" data-scroll>
                                    <span class="d-inline-block fs-sm text-body align-middle mt-1 ms-1"></span>
                                </a>
                                <button class="btn-wishlist me-0 me-lg-n3" type="button" data-bs-toggle="tooltip" title="Add to wishlist">
                                    <i class="ci-heart"></i>
                                </button>
                            </div>

                            <!--가격-->
                            <div class="mb-3"><span class="h3 fw-normal text-accent me-1"
                                                    th:text="${product.instantPrice}"><small>원</small></span>
                                <del class="fs-lg me-3">원</del>
                            </div>

                            <div class="fs-sm mb-4">
                                <span class="text-heading fw-medium me-1">카테고리:</span>
                                <span class="text-muted" id="colorOption1"
                                      th:utext="${product.categoryRecordDto.getSecond()}"></span>
                                <span class="text-muted" id="colorOption2"
                                      th:text="${product.categoryRecordDto.getFirst()}"></span>
                            </div>


                            <!-- Product panels-->
                            <div class="accordion mb-4" id="productPanels">
                                <div class="accordion-item">
                                    <h3 class="accordion-header"><a class="accordion-button" href="#productInfo"
                                                                    role="button" data-bs-toggle="collapse"
                                                                    aria-expanded="true" aria-controls="productInfo">
                                        <i class="ci-announcement text-muted fs-lg align-middle mt-n1 me-2"></i>Product
                                        info</a>
                                    </h3>
                                    <div class="accordion-collapse collapse show" id="productInfo"
                                         data-bs-parent="#productPanels">
                                        <div class="accordion-body">

                                            <h6 class="fs-sm mb-2">등록 형태 </h6>
                                            <ul class="fs-sm ps-4">
                                                <li class="" th:text="${product.productTime.getDescription()}"></li>
                                            </ul>

                                            <h6 class="fs-sm mb-2" th:classappend="${product.productTime.equals( productTime[2])} ?  'd-none' : ''">경매 가격 </h6>
                                            <ul class="fs-sm ps-4" >
                                                <li class="" th:text=" ${maxAuctionPrice} == -1 ? ${product.auctionPrice} : ${ maxAuctionPrice }"></li>
                                            </ul>

                                            <h6 class="fs-sm mb-2">상세 설명</h6>
                                            <ul class="fs-sm ps-4">
                                                <li class="" th:text="${ product.explanation }"></li>
                                            </ul>


                                            <h6 th:id="deadLine" class="fs-sm mb-2">마감시간</h6>
                                            <ul class="fs-sm ps-4">
                                                <li th:id="*{ product.productTime}"></li>
                                            </ul>

                                    <!--   <h6 class="fs-sm mb-2">Art. No.</h6>
                                            <ul class="fs-sm ps-4 mb-0">
                                                <li>"*{}"</li>
                                            </ul>-->
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <form action="" th:action="@{/product/order/inCart}" method="post">

                                <input type="hidden" th:id="memberId" th:name="memberid"
                                       th:if="${session.loginMember != null}"
                                       th:value="${session.loginMember.getId()}"/>
                                <input type="hidden" th:id="productId" th:name="productid" th:value="${product.id}"/>


                                <button class="btn btn-primary btn-shadow d-block w-100" type="submit"><i
                                        class="ci-cart fs-lg me-2"></i>카트에 담기
                                </button>
                            </form>

                            <form action="" th:action="@{/product/order/buyNow}" method="post">
                                <input type="hidden" th:id="memberId" th:name="memberId"
                                       th:if="${session.loginMember != null}"
                                       th:value="${session.loginMember.getId()}"/>
                                <input type="hidden" th:id="productId" th:name="productId" th:value="${product.id}"/>

                                <button class="btn btn-danger d-block w-100 my-1" type="submit"><i
                                        class="ci-send fs-lg me-2"></i>즉시 구매
                                </button>
                            </form>


                            <button type="button" class="btn btn-info d-block w-100 my-1" data-bs-toggle="modal"
                                    data-bs-target="#auctionModal">
                                <i class="ci-store fs-lg me-2"></i>경매 구매
                            </button>

                            <!-- Sharing-->
                            <label class="form-label d-inline-block align-middle my-2 me-3">Share:</label><a
                                class="btn-share btn-twitter me-2 my-2" href="#"><i class="ci-twitter"></i>Twitter</a><a
                                class="btn-share btn-instagram me-2 my-2" href="#"><i class="ci-instagram"></i>Instagram</a><a
                                class="btn-share btn-facebook my-2" href="#"><i class="ci-facebook"></i>Facebook</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Product carousel (Style with)-->
        <div class="container pt-5">
            <h2 class="h3 text-center pb-4">이런 물품도 있어요</h2>
            <div class="tns-carousel tns-controls-static tns-controls-outside">
                <div class="tns-carousel-inner"
                     data-carousel-options="{&quot;items&quot;: 2, &quot;controls&quot;: true, &quot;nav&quot;: false, &quot;responsive&quot;: {&quot;0&quot;:{&quot;items&quot;:1},&quot;500&quot;:{&quot;items&quot;:2, &quot;gutter&quot;: 18},&quot;768&quot;:{&quot;items&quot;:3, &quot;gutter&quot;: 20}, &quot;1100&quot;:{&quot;items&quot;:4, &quot;gutter&quot;: 30}}}">
                    <!-- Product-->
                    <div th:each="product : ${crawlingdata}">
                        <div class="card product-card card-static">
                            <button class="btn-wishlist btn-sm" type="button" data-bs-toggle="tooltip"
                                    data-bs-placement="left" title="Add to wishlist">
                                <i class="ci-heart"></i>
                            </button>
                            <a class="card-img-top d-block overflow-hidden" href="#">
                                <img th:src="${product.getImg_link()}"
                                     alt="Product">
                            </a>
                            <div class="card-body py-2">
                                <h3 class="product-title fs-sm">
                                    <a th:href="${product.getLink()}" th:text="${product.getName()}">물품제목</a>
                                </h3>
                                <div class="d-flex justify-content-between">
                                    <div class="product-price">
                                    <span class="text-accent" th:text="|${product.getPrice()} 원|">
                                      <small></small>
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>
</main>
<script th:inline="javascript">

    const timeType = [[${product.productTime}]];
    const deadLineString = [[${#temporals.format( product.deadLine , 'yyyy-MM-dd HH:mm:ss')}]]
    const now = new Date();
    const deadLine = new Date(Number(deadLineString.slice(0, 4)),
        Number(deadLineString.slice(5, 7)) - 1,
        Number(deadLineString.slice(8, 10)),
        Number(deadLineString.slice(11, 13)),
        Number(deadLineString.slice(14, 16)),
        Number(deadLineString.slice(17, 19)),
    );
    const remainingTime = deadLine.getTime() - now.getTime();
    if (remainingTime > 0) {


        let totalSec = parseInt(remainingTime / 1000);

        let hour = parseInt(totalSec / 3600);
        let min = parseInt((totalSec - hour * 60 * 60) / 60);
        let sec = totalSec % 60;
        $("#" + timeType).text(hour + "시 " + min + "분 " + sec + "초");

        let timer = setInterval(() => {

            hour = parseInt(totalSec / 3600);
            min = parseInt((totalSec - hour * 60 * 60) / 60);
            sec = totalSec % 60;

            $("#" + timeType).text(hour + "시 " + min + "분 " + sec + "초");

            totalSec--;

            if (totalSec < 0) {
                clearInterval(timer);
            }

        }, 1000);
    } else {
        $("#deadLine").remove();
    }

</script>
</body>
</html>